{% extends 'base.html' %} {% block content %}
<!--  -->

<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col"></th>
                <th scope="col">Jour</th>
                <th scope="col">Cum</th>
                <th scope="col">Delta</th>
              </tr>
            </thead>
            <tbody>
              <tr class="table-success">
                <th scope="row">
                  <span
                    data-bs-toggle="collapse"
                    href="#collapseExample"
                    role="button"
                    aria-expanded="false"
                    aria-controls="collapseExample"
                  >
                    (+)
                  </span>
                  Chiffre d' Affaire
                </th>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{get_sales_on_date(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{get_sales_on_date(cum=True)}}
                    <small>TND</small></span
                  >
                </td>
                <td></td>
              </tr>
              {% for salesCategorie in salesCategories %}
              <tr class="collapse" id="collapseExample">
                <th scope="row">{{salesCategorie.name}}</th>
                <td>
                  <span
                    class="badge bg-success rounded-pill"
                    style="font-size: 1em"
                  >
                    ----
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-primary rounded-pill">
                    ----
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-primary rounded-pill">
                    14
                    <small>TND</small>
                  </span>
                </td>
              </tr>
              {% endfor %}

              <tr class="table-secondary">
                <th scope="row">Stock initial</th>
                <td>
                  <span class="badge bg-secondary rounded-pill">
                    {{get_stock_on_date(initial=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-secondary rounded-pill">
                    {{get_stock_on_date(initial=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-secondary">
                <th scope="row">Stock final</th>
                <td>
                  <span class="badge bg-secondary rounded-pill">
                    {{get_stock_on_date()}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-secondary rounded-pill">
                    {{get_stock_on_date()}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-light">
                <th scope="row">Variation du Stock</th>
                <td>
                  <span class="badge bg-dark rounded-pill">
                    {{get_stock_on_date(initial=True) - get_stock_on_date()}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-dark rounded-pill">
                    {{get_stock_on_date(initial=True) - get_stock_on_date()}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-warning">
                <th scope="row">(+) Achat</th>
                <td>
                  <span class="badge bg-warning rounded-pill">
                    {{get_purchasing_on_date(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-warning rounded-pill">
                    {{get_purchasing_on_date(cum=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-info">
                <th scope="row">
                  Cout de Marchandise vendus <small>(variation + achat)</small>
                </th>
                <td>
                  <span class="badge bg-light text-dark rounded-pill">
                    {{get_costo_goods_sold(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-light text-dark rounded-pill">
                    {{get_costo_goods_sold(cum=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-success">
                <th scope="row">
                  Marge brute (Chiffre d'affaire - Cout de Marchandise vendus)
                </th>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{get_gross_margin(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{get_gross_margin(cum=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>

              <tr class="table-danger">
                <th scope="row">(+) Charge Fix</th>
                <td>
                  <span class="badge bg-danger rounded-pill">
                    {{get_costs_on_date(today=True,fixed=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-danger rounded-pill">
                    {{get_costs_on_date(cum=True,fixed=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-danger">
                <th scope="row">(+) Charge Variable</th>
                <td>
                  <span class="badge bg-danger rounded-pill">
                    {{get_costs_on_date(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-danger rounded-pill">
                    {{get_costs_on_date(cum=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-success">
                <th scope="row">
                  Resultat brut d'exploitation
                  <small>(Marge brute - charge fix et variable) </small>
                </th>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{get_gross_operating_income(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{get_gross_operating_income(cum=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-warning">
                <th scope="row">Amortissement</th>
                <td>
                  <span class="badge bg-warning rounded-pill">
                    ---
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-warning rounded-pill">
                    ---
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-danger">
                <th scope="row">
                  Impot sur resultat d'exploitation (25% du Resultat brut
                  d'exploitation --> als variable in DB)
                </th>
                <td>
                  <span class="badge bg-danger rounded-pill">
                    {{ get_tax_gross_operating_income(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-danger rounded-pill">
                    {{ get_tax_gross_operating_income(cum=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
              <tr class="table-success">
                <th scope="row">
                  Resultat net d'exploitation
                  <small
                    >(Resultat brut d'exploitation -amortissment - Impot sur
                    resultat d'exploitation)</small
                  >
                </th>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{ get_net_operating_income(today=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td>
                  <span class="badge bg-success rounded-pill">
                    {{ get_net_operating_income(cum=True)}}
                    <small>TND</small>
                  </span>
                </td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
